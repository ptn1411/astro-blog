---
import Headline from '~/components/blog/Headline.astro';

export interface Props {
  title?: string;
  subtitle?: string;
  tagline?: string;
  plans?: Array<{
    name: string;
    features: Array<{ name: string; included: boolean }>;
  }>;
  id?: string;
  isDark?: boolean;
  classes?: Record<string, string>;
  bg?: string;
}

const { title = '', subtitle = '', tagline = '', plans = [], id, isDark = false, classes = {}, bg = '' } = Astro.props;

// Get all unique feature names from the first plan
const featureNames = plans[0]?.features?.map((f) => f.name) || [];
---

<section
  class:list={['relative not-prose scroll-mt-[72px]', { dark: isDark }, classes?.container]}
  {...id ? { id } : {}}>
  <Fragment set:html={bg} />

  <div class="relative px-4 py-16 md:py-20 lg:py-24 max-w-6xl mx-auto">
    <Headline title={title} subtitle={subtitle} tagline={tagline} />

    <div class="overflow-x-auto">
      <table class="w-full border-collapse">
        <thead>
          <tr class="bg-gray-100 dark:bg-slate-800">
            <th class="p-4 text-left dark:text-white">Feature</th>
            {plans.map((plan) => <th class="p-4 text-center font-bold dark:text-white">{plan.name}</th>)}
          </tr>
        </thead>
        <tbody>
          {
            featureNames.map((featureName, fi) => (
              <tr class="border-b dark:border-slate-700">
                <td class="p-4 dark:text-slate-300">{featureName}</td>
                {plans.map((plan) => (
                  <td class="p-4 text-center">
                    {plan.features[fi]?.included ? (
                      <span class="text-green-600 dark:text-green-400 text-xl">✓</span>
                    ) : (
                      <span class="text-gray-300 dark:text-slate-600 text-xl">−</span>
                    )}
                  </td>
                ))}
              </tr>
            ))
          }
        </tbody>
      </table>
    </div>
  </div>
</section>
