---
import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import type { Widget } from '~/types';

export interface Props extends Widget {
  title?: string;
  message?: string;
  type?: 'info' | 'success' | 'warning' | 'error';
  dismissible?: boolean;
}

const {
  title = '',
  message = '',
  type = 'info',
  dismissible = false,
  id,
  isDark = false,
  classes = {},
  bg = await Astro.slots.render('bg'),
  ...rest
} = Astro.props;

const colors = {
  info: 'bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-300',
  success: 'bg-green-50 dark:bg-green-900/30 border-green-500 text-green-700 dark:text-green-300',
  warning: 'bg-yellow-50 dark:bg-yellow-900/30 border-yellow-500 text-yellow-700 dark:text-yellow-300',
  error: 'bg-red-50 dark:bg-red-900/30 border-red-500 text-red-700 dark:text-red-300',
};

const icons = {
  info: 'ℹ️',
  success: '✓',
  warning: '⚠️',
  error: '✕',
};
---

<WidgetWrapper id={id} isDark={isDark} containerClass={`my-4 ${classes?.container ?? ''}`} bg={bg} {...rest}>
  <div class:list={['border-l-4 p-4 rounded-r-lg', colors[type]]} role="alert">
    <div class="flex justify-between items-start">
      <div class="flex gap-3">
        <span class="text-lg flex-shrink-0">{icons[type]}</span>
        <div>
          {title && <p class="font-bold mb-1">{title}</p>}
          {message && <p set:html={message} />}
        </div>
      </div>
      {
        dismissible && (
          <button
            type="button"
            class="text-xl font-bold opacity-50 hover:opacity-100 transition-opacity"
            onclick="this.parentElement.parentElement.remove()"
            aria-label="Dismiss">
            ×
          </button>
        )
      }
    </div>
  </div>
</WidgetWrapper>
