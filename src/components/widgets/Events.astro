---
import Headline from '~/components/blog/Headline.astro';
import Button from '~/components/ui/Button.astro';

export interface Props {
  title?: string;
  subtitle?: string;
  tagline?: string;
  events?: Array<{
    title: string;
    description?: string;
    date: string;
    time?: string;
    location?: string;
    link?: { text?: string; href: string };
  }>;
  id?: string;
  isDark?: boolean;
  classes?: Record<string, string>;
  bg?: string;
}

const { title = '', subtitle = '', tagline = '', events = [], id, isDark = false, classes = {}, bg = '' } = Astro.props;

function formatDate(dateStr: string) {
  const date = new Date(dateStr);
  return {
    day: date.getDate(),
    month: date.toLocaleString('default', { month: 'short' }),
    year: date.getFullYear(),
  };
}
---

<section
  class:list={['relative not-prose scroll-mt-[72px]', { dark: isDark }, classes?.container]}
  {...id ? { id } : {}}>
  <Fragment set:html={bg} />

  <div class="relative px-4 py-16 md:py-20 lg:py-24 max-w-6xl mx-auto">
    <Headline title={title} subtitle={subtitle} tagline={tagline} />

    <div class="space-y-6">
      {
        events.map((event) => {
          const { day, month } = formatDate(event.date);
          return (
            <div class="flex gap-6 p-6 bg-white dark:bg-slate-900 rounded-xl shadow-lg">
              <div class="flex-shrink-0 w-20 text-center">
                <div class="text-3xl font-bold text-blue-600 dark:text-blue-400">{day}</div>
                <div class="text-sm text-gray-500 dark:text-slate-400 uppercase">{month}</div>
              </div>
              <div class="flex-1">
                <h3 class="font-bold text-xl mb-2 dark:text-white">{event.title}</h3>
                {event.description && <p class="text-gray-600 dark:text-slate-400 mb-2" set:html={event.description} />}
                <div class="flex gap-4 text-sm text-gray-500 dark:text-slate-400">
                  {event.location && <span>ğŸ“ {event.location}</span>}
                  {event.time && <span>ğŸ• {event.time}</span>}
                </div>
              </div>
              {event.link && (
                <div class="self-center">
                  <Button href={event.link.href} variant="primary">
                    {event.link.text || 'Register'}
                  </Button>
                </div>
              )}
            </div>
          );
        })
      }
    </div>
  </div>
</section>
