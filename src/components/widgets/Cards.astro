---
import Image from '~/components/common/Image.astro';
import Headline from '~/components/ui/Headline.astro';
import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import type { Widget } from '~/types';

export interface Props extends Widget {
  title?: string;
  subtitle?: string;
  tagline?: string;
  cards?: {
    title: string;
    description?: string;
    image?: { src: string; alt?: string };
    link?: { href: string; text: string };
  }[];
  columns?: number;
}

const {
  title = '',
  subtitle = '',
  tagline = '',
  cards = [],
  columns = 3,
  id,
  isDark = false,
  classes = {},
  bg = await Astro.slots.render('bg'),
  ...rest
} = Astro.props;

const colsClass =
  {
    1: 'lg:grid-cols-1',
    2: 'lg:grid-cols-2',
    3: 'lg:grid-cols-3',
    4: 'lg:grid-cols-4',
  }[columns] || 'lg:grid-cols-3';
---

<WidgetWrapper
  id={id}
  isDark={isDark}
  containerClass={`max-w-7xl mx-auto ${classes?.container ?? ''}`}
  bg={bg}
  {...rest}>
  <Headline title={title} subtitle={subtitle} tagline={tagline} />

  <div class:list={['grid gap-8', colsClass]}>
    {
      cards.map((card) => (
        <div class="flex flex-col bg-white dark:bg-slate-900 rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
          {card.image && <Image class="w-full h-48 object-cover" width={400} height={200} {...card.image} />}
          <div class="p-6 flex flex-grow flex-col">
            <h3 class="text-xl font-bold mb-2 dark:text-white">{card.title}</h3>
            {card.description && <p class="text-gray-600 dark:text-slate-400 mb-4 flex-grow">{card.description}</p>}
            {card.link && (
              <a href={card.link.href} class="text-blue-600 dark:text-blue-400 font-semibold hover:underline">
                {card.link.text} â†’
              </a>
            )}
          </div>
        </div>
      ))
    }
  </div>
</WidgetWrapper>
