---
import Image from '~/components/common/Image.astro';
import Headline from '~/components/ui/Headline.astro';
import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import type { Testimonials as Props } from '~/types';

const {
  title = await Astro.slots.render('title'),
  subtitle = await Astro.slots.render('subtitle'),
  tagline = await Astro.slots.render('tagline'),
  testimonials = [],
  id,
  isDark = false,
  classes = {},
  bg = await Astro.slots.render('bg'),
  ...rest
} = Astro.props;
---

<WidgetWrapper
  id={id}
  isDark={isDark}
  containerClass={`max-w-7xl mx-auto ${classes?.container ?? ''}`}
  bg={bg}
  {...rest}>
  <Headline title={title} subtitle={subtitle} tagline={tagline} />
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 px-4">
    {
      testimonials.map(({ testimonial, name, job, image }) => (
        <div class="flex flex-col p-6 bg-white dark:bg-slate-900 rounded-xl shadow border border-gray-100 dark:border-slate-800">
          <div class="mb-4">
            <svg class="w-8 h-8 text-blue-100 dark:text-blue-900" fill="currentColor" viewBox="0 0 32 32">
              <path d="M10 8v8h6v2H10v8h8V8h-8zm12 0v8h6v2h-6v8h8V8h-8z" />
            </svg>
          </div>
          <p class="text-gray-600 dark:text-slate-400 flex-grow italic mb-6">"{testimonial}"</p>
          <div class="flex items-center gap-4">
            {image && (
              <Image
                class="w-12 h-12 rounded-full object-cover"
                width={48}
                height={48}
                widths={[400]}
                sizes="48px"
                {...image}
              />
            )}
            <div class="text-left">
              <h4 class="font-bold dark:text-white leading-tight">{name}</h4>
              {job && <p class="text-xs text-muted dark:text-slate-500">{job}</p>}
            </div>
          </div>
        </div>
      ))
    }
  </div>
</WidgetWrapper>
